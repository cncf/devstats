metrics:
  - name: Companies stats & velocity
    series_name_or_func: multi_row_multi_column
    sqls: [company_activity, company_activity_commits]
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    multi_value: true
    merge_series: company_activity
    drop: scompany_activity
  - name: PRs authors companies histogram
    histogram: true
    annotations_ranges: true
    series_name_or_func: multi_row_single_column
    sql: hist_pr_companies
    merge_series: hpr_comps
  - name: Number of companies and developers contributing
    series_name_or_func: multi_row_multi_column
    sql: num_stats
    periods: d,w,m,q
    aggregate: 1,7,28
    skip: d,w7,m7,q7,w28,m28,q28
    merge_series: num_stats
    drop: snum_stats
  - name: Company summaries
    sqls: [project_company_stats, doc_committers_hist]
    series_name_or_func: multi_row_single_column
    histogram: true
    annotations_ranges: true
    merge_series: hcom
  - name: Countries stats
    series_name_or_func: multi_row_multi_column
    sqls: [countries, committers_countries]
    periods: w,m,q,m6,y,y2,y3,y5
    multi_value: true
    merge_series: countries
    drop: scountries
  - name: Countries stats cumulative
    series_name_or_func: multi_row_multi_column
    sqls: [countries_cum, committers_countries_cum]
    periods: m
    multi_value: true
    merge_series: countriescum
    drop: scountriescum
    env:
      GHA2DB_NCPUS?: 4
  - name: Countries Projects stats
    series_name_or_func: multi_row_multi_column
    sqls: [project_countries, project_countries_commiters]
    periods: m,q,y
    multi_value: true
    skip_escape_series_name: true
    hll: true
    merge_series: prjcntr
    drop: sprjcntr
  - name: Company PRs in repository groups
    sql: company_prs
    series_name_or_func: company_prs
    histogram: true
    annotations_ranges: true
  - name: Company commits table
    series_name_or_func: multi_row_single_column
    sql: company_commits_data
    custom_data: true
    merge_series: company_commits_data
    periods: d
    drop: scompany_commits_data
  - name: Documentation committers stats
    series_name_or_func: multi_row_multi_column
    sql: doc_committers
    periods: d,w,m,q
    aggregate: 1,7
    skip: d,w7,m7,q7
    merge_series: doc_committers
    drop: sdoc_committers
  - name: Developer summary
    sql: project_developer_stats
    series_name_or_func: multi_row_single_column
    histogram: true
    annotations_ranges: true
    allow_fail: true
    wait_after_fail: 600
    merge_series: hdev
    env:
      GHA2DB_NCPUS?: 2
  - name: Contributions chart
    series_name_or_func: multi_row_multi_column
    sqls: [committers, contributors]
    periods: w,m
    merge_series: cs
    drop: scs
    project: '!kubernetes'
    env:
      GHA2DB_NCPUS?@d7: 4
      GHA2DB_NCPUS?!d7: 10
  - name: Company contribution counts in repository groups
    histogram: true
    annotations_ranges: true
    series_name_or_func: multi_row_single_column
    sql: company_contribution_counts
    merge_series: hcom_contrib
  - name: Bus factor in repository groups
    histogram: true
    annotations_ranges: true
    series_name_or_func: multi_row_single_column
    sql: bus_factor
    merge_series: hbf
    allow_fail: true
    env:
      GHA2DB_NCPUS?: 2
  - name: Contributors and organizations
    series_name_or_func: single_row_multi_column
    sql: contributors_and_orgs_count
    periods: m
    merge_series: cntrs_and_orgs
    drop: 'scntrs_and_orgs'
    always_recalc: true
  - name: Projects health
    series_name_or_func: multi_row_single_column
    sql: projects_health
    merge_series: projects_health
    histogram: true
    custom_data: true
    periods: d
    series_name_map:
      # Mapping must be from normalized(repo group name)
      #    repo group name is from some "All ..." project like scripts/all/repo_groups.sql, scripts/graphql/repo_groups.sql, scripts/allcdf/repo_groups.sql  
      # To project key in projects.json (projectname: value).
      #    if they are the same, then mapping is not needed
      # Note that project key must match partials/projects_health*.html phealth... (hardcoded value)
      # * can also be _cdf/_qql: partials/projects_health_gql.html, partials/projects_health_cdf.html
      # From can be checked:
      #    select distinct repo_group from gha_repos where lower(repo_group) like '%word1%word2%';
      #    select * from tall_repo_groups where all_repo_group_value = 'from';
      # To can be checked:
      #    select distinct period from sannotations_shared where period = 'to';
      piraeusdatastore: piraeus
      wasmedgeruntime: wasmedge
      vscodekubernetestools: vscodek8stools
      cubefs: chubaofs
      opengitops: gitopswg
      tokenetes: tratteria
      openpolicyagent: opa
      metal3io: metal3
      connectrpc: connect
      copa: copacetic
      hexa: hexapolicyorchestrator
      krkn: krknchaos
